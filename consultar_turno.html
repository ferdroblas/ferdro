<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <script>
      function searchEvents() {
        const email = document.getElementById('email').value;
        google.script.run.withSuccessHandler(displayResults).getEventsByEmail(email);
      }

      function displayResults(events) {
        const resultsDiv = document.getElementById('results');
        resultsDiv.innerHTML = '';

        if (events.length === 0) {
          resultsDiv.innerHTML = 'No se encontraron eventos para este correo electrónico.';
          return;
        }

        events.forEach(event => {
          const eventDiv = document.createElement('div');
          eventDiv.innerHTML = `<p><strong>Título:</strong> ${event.title}</p>
                                <p><strong>Inicio:</strong> ${new Date(event.startTime).toLocaleString()}</p>
                                <p><strong>Fin:</strong> ${new Date(event.endTime).toLocaleString()}</p>
                                <p><strong>Ubicación:</strong> ${event.location}</p>
                                <p><strong>Descripción:</strong> ${event.description}</p>
                                <hr>`;
          resultsDiv.appendChild(eventDiv);
        });
      }
    </script>
  </head>
  <body>
    <h1>Consultar mi próximo turno</h1>
    <label for="email">Correo electrónico del invitado:</label>
    <input type="email" id="email" name="email" required>
    <button onclick="searchEvents()">Buscar</button>
    <div id="results"></div>
  </body>
</html>
