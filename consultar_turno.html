

<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Buscar por DNI</title>
  <!-- Incluir la biblioteca de Google Sheets API -->
  <script src="https://apis.google.com/js/api.js"></script>
  <script>
    var CLIENT_ID = '521200181277-ggt79gnbpmco2qfl320pab9emrulr70m.apps.googleusercontent.com'; // Reemplaza con tu ID de cliente OAuth 2.0
    var API_KEY = 'AIzaSyBhMb4dKz32uaau91j7KEYI1rpnmNgbtmI'; // Reemplaza con tu clave API de Google Cloud Platform
    var SPREADSHEET_ID = '1E_g45qALP3E3jKkJ-myXezksGBoHUflveY51LA0YibE'; // Reemplaza con el ID de tu hoja de cálculo
    var SCOPE = 'https://www.googleapis.com/auth/spreadsheets.readonly'; // Ámbito de permisos para solo lectura

    function handleClientLoad() {
      gapi.load('client:auth2', initClient);
    }

    function initClient() {
      gapi.client.init({
        apiKey: API_KEY,
        clientId: CLIENT_ID,
        discoveryDocs: ["https://sheets.googleapis.com/$discovery/rest?version=v4"],
        scope: SCOPE
      }).then(function() {
        // Escuchar el evento de clic en el botón de búsqueda
        document.getElementById('searchButton').addEventListener('click', searchByDni);
      });
    }

    function searchByDni() {
      var dni = document.getElementById('dni').value.trim();
      gapi.auth2.getAuthInstance().signIn().then(function() {
        gapi.client.sheets.spreadsheets.values.get({
          spreadsheetId: SPREADSHEET_ID,
          range: 'Turnos!A:F', // Ajusta el rango según tu hoja de cálculo
        }).then(function(response) {
          var values = response.result.values;
          var results = values.filter(row => row[0] === dni); // Suponiendo que DNI está en la tercera columna (index 2)

          displayResults(results);
        }, function(error) {
          console.error('Error al buscar por DNI:', error);
        });
      });
    }

    function displayResults(results) {
      var resultsDiv = document.getElementById('results');
      resultsDiv.innerHTML = '';

      if (!results || results.length === 0) {
        resultsDiv.innerHTML = 'No se encontraron resultados.';
        return;
      }

      results.forEach(function(row) {
        var resultDiv = document.createElement('div');
        resultDiv.innerHTML = '<p><strong>Apellido:</strong> ' + row[3] + '</p>' +
                              '<p><strong>Nombre:</strong> ' + row[4] + '</p>' +
                              '<p><strong>DNI:</strong> ' + row[0] + '</p>' +
                              '<hr>';
        resultsDiv.appendChild(resultDiv);
      });
    }
  </script>
</head>
<body>
  <h1>Buscar por DNI</h1>
  <label for="dni">Ingrese el DNI:</label>
  <input type="text" id="dni" name="dni" required>
  <button id="searchButton">Buscar</button>

  <div id="results"></div>

  <!-- Incluir el script para la API de Google Client -->
  <script async defer src="https://apis.google.com/js/api.js?onload=handleClientLoad"></script>
</body>
</html>
